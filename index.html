<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Copyright (c) 2025 Ben Schoepke. All rights reserved. -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>yousampler</title>
    <link rel="icon" type="image/svg+xml" href="favico.svg">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E8SRWE7BBB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-E8SRWE7BBB');
    </script>

    <script>
        if (window.location.protocol === 'file:') {
            alert("⚠️ YouTube API Error Warning ⚠️\n\nRunning this app directly from a file (file://) causes YouTube Error 153.\n\nPlease run this app using a local server.\n\nWe can start one for you!");
        }
    </script>
</head>


<body>
    <div class="app-container">
        <!-- Compact Header -->
        <header class="compact-header">
            <div class="header-left">
                <button class="btn-icon" id="btn-play-pause" title="SPACE">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" id="play-pause-icon">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                </button>
                <button id="btn-midi-toggle" title="Toggle MIDI">MIDI</button>
            </div>
            <div class="header-center">
                <a href="/" class="logo-link">
                    <img src="logo.svg" alt="yousampler" class="branding-logo">
                </a>
            </div>
            <div class="header-right">
                <button class="btn-icon" id="btn-fullscreen" title="Full Screen">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round" style="margin-top: -4px;">
                        <rect x="2" y="7" width="20" height="15" rx="2" ry="2"></rect>
                        <polyline points="17 2 12 7 7 2"></polyline>
                    </svg>
                    <span class="btn-label">Fullscreen</span>
                </button>
                <button class="btn-icon" id="btn-share" title="Copy URL">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round" id="ios-share-icon">
                        <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                        <polyline points="16 6 12 2 8 6"></polyline>
                        <line x1="12" y1="2" x2="12" y2="15"></line>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Grid Section -->
        <main class="grid-section">
            <div class="pad-grid" id="pad-grid">
                <!-- Pads will be generated by JS -->
            </div>
        </main>

        <!-- Compact Footer -->
        <footer class="compact-footer">
            <!-- Row 1: Controls and Title -->
            <div class="footer-row-1">
                <div class="footer-controls">
                    <!-- Volume -->
                    <div class="header-knob" id="knob-volume" title="Volume">
                        <svg class="dial-svg" viewBox="0 0 40 40">
                            <!-- Background Arc -->
                            <path class="dial-bg" d="M 2 28 A 18 18 0 0 1 38 28" fill="none" stroke="#444"
                                stroke-width="3" stroke-linecap="round" />
                            <!-- Value Arc -->
                            <path class="dial-val" id="vol-path" d="M 2 28 A 18 18 0 0 1 38 28" fill="none"
                                stroke="var(--accent-orange)" stroke-width="3" stroke-linecap="round"
                                stroke-dasharray="56.5" stroke-dashoffset="0" />
                            <!-- Icon -->
                            <g transform="translate(13, 16) scale(0.6)" fill="#aaa">
                                <path
                                    d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z" />
                            </g>
                        </svg>
                    </div>
                    <!-- Pitch -->
                    <div class="header-knob" id="knob-pitch" title="Playback Speed">
                        <svg class="dial-svg" viewBox="0 0 40 40">
                            <!-- Background Arc -->
                            <path class="dial-bg" d="M 2 28 A 18 18 0 0 1 38 28" fill="none" stroke="#444"
                                stroke-width="3" stroke-linecap="round" />
                            <!-- Value Arc -->
                            <path class="dial-val" id="pitch-path" d="M 2 28 A 18 18 0 0 1 38 28" fill="none"
                                stroke="var(--accent-blue)" stroke-width="3" stroke-linecap="round"
                                stroke-dasharray="56.5" stroke-dashoffset="0" />
                            <!-- Text -->
                            <text id="pitch-text" x="20" y="26" text-anchor="middle" font-size="9" fill="#aaa"
                                font-weight="bold" font-family="'Roboto Mono', monospace">1x</text>
                        </svg>
                    </div>
                    <!-- Mode -->
                    <div class="header-knob" id="mode-control-lcd" title="Playback Mode">
                        <div class="mode-options">
                            <div class="mode-option" data-mode="gate">
                                <svg class="mode-opt-icon" viewBox="0 0 24 24">
                                    <path d="M4 20v-16h16v16h-2v-14h-12v14z" />
                                </svg>
                                <span class="mode-opt-label">Gate</span>
                            </div>
                            <span class="mode-separator">|</span>
                            <div class="mode-option" data-mode="oneshot">
                                <svg class="mode-opt-icon" viewBox="0 0 24 24">
                                    <path d="M8 5v14l11-7z" />
                                </svg>
                                <span class="mode-opt-label">One Shot</span>
                            </div>
                            <span class="mode-separator">|</span>
                            <div class="mode-option" data-mode="loop">
                                <svg class="mode-opt-icon" viewBox="0 0 24 24">
                                    <path
                                        d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97-.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z" />
                                </svg>
                                <span class="mode-opt-label">Loop</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer-title">
                    <span id="video-title">Select a pad to load video</span>
                    <div class="footer-trash">
                        <div class="trash-zone" id="trash-zone" title="Drop to Delete">
                            <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                <path
                                    d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Row 2: Timeline -->
            <div class="footer-row-2">
                <div class="footer-timeline">
                    <div class="timeline-container" id="timeline-container">
                        <div class="trim-overlay left" id="trim-overlay-left"></div>
                        <div class="trim-overlay right" id="trim-overlay-right"></div>
                        <div class="timeline-track"></div>
                        <div class="playhead" id="playhead"></div>
                        <div class="trim-handle start" id="trim-start">
                            <span class="trim-time" id="start-time-display">00:00</span>
                            <svg class="trim-arrow" viewBox="0 0 12 12" fill="currentColor">
                                <path d="M8 6L3 2v8z" />
                            </svg>
                        </div>
                        <div class="trim-handle end" id="trim-end">
                            <svg class="trim-arrow" viewBox="0 0 12 12" fill="currentColor">
                                <path d="M4 6l5-4v8z" />
                            </svg>
                            <span class="trim-time" id="end-time-display">00:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </footer>

        <!-- Video Loader Modal -->
        <div class="modal-overlay" id="loader-modal">
            <div class="modal-content">
                <button id="btn-close-modal" title="Close">
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <h3>LOAD VIDEO</h3>
                <input type="text" id="video-url-input" placeholder="Paste YouTube URL here...">
                <div class="modal-actions">
                    <button id="btn-cancel-load">CANCEL</button>
                    <button id="btn-confirm-load">LOAD</button>
                </div>
                <div class="modal-divider">OR SELECT A SUGGESTED VIDEO</div>
                <div class="suggested-videos-grid" id="suggested-videos-grid">
                    <!-- Suggested video pads will be generated by JS -->
                </div>
            </div>
        </div>
    </div>

    <button id="btn-exit-fullscreen" title="Exit Full Screen">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
    </button>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="app.js"></script>
</body>

</html>